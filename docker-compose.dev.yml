version: "3"
services:
  devcontainer:
    container_name: devcontainer
    build:
      context: .
      target: dev-stage
      args:
        - USERNAME=${USER}
    ports:
      - 6007:6007
    runtime: nvidia
    env_file:
      - .env.dev
    command: /bin/sh -c "while sleep 1000; do :; done"
    volumes:
      - workspace:/workspace
      - .:/workspace:rw
      - /var/run/docker.sock:/var/run/docker.sock:rw

volumes:
  workspace:
